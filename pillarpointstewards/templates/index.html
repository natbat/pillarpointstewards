{% extends "base.html" %}
{% load static %}

{% block content %}
  {% if request.user.is_authenticated and not user_is_inactive %}
    <section class="page-title">
      <div class="title-wrapper stretch">
        <h1 class="text"><span>You are logged in as {{ request.user }}</span></h1>
        <div class="page-controls">
          {% if request.user.is_authenticated %}
            <a class="loginout" href="/logout/">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg> Logout</a>
            {% if request.user.is_staff or request.user.is_superuser %}
              &nbsp; &nbsp; <a class="loginout" href="/admin/">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg> Admin</a>
            {% endif %}
          {% else %}
            <a class="loginout" href="/login/">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg> Login or signup</a>
          {% endif %}
        </div>
      </div>
    </section> <!-- end .page-title -->

    <section class="content">
      <div class="primary">
        {% if upcoming_shifts %}
          <h2>Your upcoming shifts</h2>
          <ol class="shifts">
            {% for shift in upcoming_shifts %}
              <li class="shift">
                <a href="/shifts/{{ shift.pk }}/" class="shift-link">
                  <h3 class="date" title="{{ shift.shift_start.date }}">
                    <span class="day">{{ shift.shift_start|date:"jS" }}</span> <span class="month">{{ shift.shift_start|date:"F" }}</span>
                  </h3>
                  
                  <p class="shifttimes">On shift from {{ shift.shift_start|date:"g:iA"|lower }} to {{ shift.shift_end|date:"g:iA"|lower }} {{ shift.shift_start|date:"D" }}&nbsp;{{ shift.shift_start|date:"jS" }} {{ shift.shift_start|date:"F" }}&nbsp;{{ shift.shift_start|date:"Y" }}</p>
                  {% if shift.mllw_feet %}
                    <p class="lowtide"><strong>Low tide:</strong> {{ shift.mllw_feet }}ft at {{ shift.lowest_tide|date:"g:iA"|lower }}</p>
                  {% endif %}
                  <p class="stewards"><strong>Stewards <em>({{ shift.stewards.count }}{% if shift.target_stewards %}/{{ shift.target_stewards }}{% endif %})</em>:</strong>
                    {% for steward in shift.stewards.all %}{{ steward }} {% if not forloop.last %}, {% endif %}{% endfor %}
                  </p>
                </a>
              </li>
            {% endfor %}
          </ol>
          <form action="/shifts/calendar-instructions/" method="POST">{% csrf_token %}
            <p><button style="font-size: 0.7em" class="button">Subscribe to your shifts in your calendar</button></p>
          </form>
        {% endif %}
        <!-- <h2>Your past shifts</h2> -->

        <h2>Calendar of upcoming shifts</h2>
        {% for calendar in calendars %}
          {{ calendar }}
        {% endfor %}

        <h3>Key</h3>
        <ul class="calkey">
          <li class="yours">Your shift</li> <li class="available">volunteers needed</li> <li class="partfull">partly full shift</li> <li class="full">fully staffed shift</li>
        </ul>

        <br>

        <p class="intro"><a href="/shifts/">Agenda view of shifts</a></p>
      </div>
      <div class="secondary pull-out">
          {{ contact_details|safe }}
      </div> <!-- end .secondary -->
      </section>

  {% else %}
    <section class="page-title">
      <div class="title-wrapper stretch">
        <h1 class="text"><span>Join the Pillar Point Tidepool Stewards</span></h1>
        <div class="page-controls">
          {% if request.user.is_authenticated %}
            <a class="loginout" href="/logout/">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg> Logout</a>
          {% else %}
            <a class="loginout" href="/login/">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg> Login or signup</a>
          {% endif %}
        </div>
      </div>
    </section> <!-- end .page-title -->
    <section class="content">
      <div class="primary">
        {% if user_is_inactive %}
          <div class="alert">Thanks for signing up, your account is not yet active - please talk to Natalie</div>
        {% endif %}
        <p class="intro">The pandemic has brought thousands of new visitors to Pillar Point
        Reef and the increased harvesting is taking its toll on the ecology of the area.</p>
        
        <p class="intro">The <a href="https://www.mpacollaborative.org/sanmateo/">San Mateo MPA Collaborative</a> and <a href="https://calacademy.org/">California Academy of Sciences</a>
        is launching this new initiative to inspire curiosity and discourage 
        unsustainable harvesting practices of marine life, to help the recovery of 
        wildlife in the area and ensure a productive, biodiverse reef for generations 
        to come.</p>

        <div class="image-wrapper">
          <img src="{% static "content/reefabove.jpg" %}" alt"">
          <p class="image-context meta">Photo (c) by Rob Cala</p>
        </div>
        
        <h2>Apply to be a volunteer</h2>

        <img src="{% static "content/mappoint.png" %}" alt"" class="pull-left-image">
        <p>We are looking for enthusiastic friendly adults (18+) to volunteer to talk 
        to visitors about 3-5 times a year on Pillar Point Reef in Half Moon Bay 
        during really low tides.</p>
           
        <p><a href="http://signup.pillarpointstewards.com/" class="button">Apply to join the volunteer program</a></p>
           
        <p>There is a two day training to help you get all the knowledge and techniques 
        youâ€™ll need. If you fill in the 
        <a href="http://signup.pillarpointstewards.com/">volunteer application form</a>, 
        we'll let you know when we schedule the next training</p>
          <br>

      </div>
      <div class="secondary pull-out">
          <h2>More information</h2>
          
          <h3>Apply to volunteer</h3>
          <ul class="bullets">
            <li><a href="http://signup.pillarpointstewards.com/">Fill in the volunteer application form</a></li>
          </ul>

          <p><a href="http://www.pillarpointstewards.com/login/" class="button">Volunteer login</a></p>


          <h3>Fishing License information</h3>
          <ul class="bullets">
            <li><a href="https://wildlife.ca.gov/Fishing/Ocean/Regulations/Sport-Fishing">CDFW Ocean Sport Fishing Regulations</a></li>
            <li><a href="https://nrm.dfg.ca.gov/FileHandler.ashx?DocumentID=199167&inline">Download the regulatins handbook</a></li>
            <li>You need a <a href="https://wildlife.ca.gov/Licensing/Fishing">license</a> to fish or collect invertebrates and other creatures at Pillar Point Reef. <a href="https://wildlife.ca.gov/Licensing/Online-Sales">Buy a license online</a></li>
            <li>&hellip; or <a href="https://www.ca.wildlifelicense.com/internetsales/OutletSearch/FindOutlet">buy a license locally</a> at <strong>Ace Hardware</strong> on Main street in HMB or the <strong>Sportfishing and Tackle shop</strong> near Johnson Pier in El Granada</li>
          </ul>

          
      </div> <!-- end .secondary -->
    </section>
  {% endif %}

{% endblock %}
